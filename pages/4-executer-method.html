<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Executer & Method</title>
    <link rel="stylesheet" href="../style.css">
</head>

<body>
    <main>
        <h1 id="executers-and-methods">Executer &amp; Method</h1>
        <p>Bảng các executer và method hỗ trợ, mô tả chi tiết từng method.</p>
        <h2>RETURN: điều khiển kết quả trả về</h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>return.PASS</b></td>
                    <td>
                        <pre>
<b>- test_item_value:</b> giá trị, có thể bỏ qua
                        </pre>
                    </td>
                    <td>PASS</td>
                    <td>
                        Dùng để kết thúc test_item với kết quả PASS. Bỏ qua các bước tiếp theo trong test_item
                    </td>
                    <td>
                        - Nếu test_item có lower_limit hoặc upper_limit là
                        số, sẽ tự check test_item_value với limit,
                        nếu quá limit sẽ trả về {tên item}_TO_LOW hoặc tên {item}_TO_HIGH
                    </td>
                </tr>
                <tr>
                    <td><b>return.FAIL</b></td>
                    <td>
                        <pre>
<b>- error_code:</b> tên lỗi
<b>- more_infomation:</b> chi tiết, có thể bỏ qua
<b>- test_item_value:</b>giá trị trả về, có thể bỏ qua
                        </pre>
                    </td>
                    <td>FAIL</td>
                    <td>
                        Dùng để kết thúc test_item với kết quả FAIL và ghi mã lỗi. Bỏ qua các bước tiếp theo trong
                        test_item.
                    </td>
                    <td>Mã lỗi nên đề là UPPER_CASE_WITH_UNDERSCORES.</td>
                </tr>
            </tbody>
        </table>

        <h2>mes: giao tiếp với MES</h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>mes.is_online</b></td>
                    <td>~</td>
                    <td>true false</td>
                    <td>Trả về on_success nếu chương trình chạy mode PRODUCTION, và ngược lại.</td>
                    <td></td>
                </tr>
                <tr>
                    <td><b>mes.CHECK_MBS_NO</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>Kiểm tra đầu vào MBSNO. Mọi trạm test qua MES đều cần.</td>
                    <td>Nếu chế độ là OFFLINE => trả về PASS.</td>
                </tr>
                <tr>
                    <td><b>mes.GET_CSN</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>
                        Lấy giá trị CSN của MBSNO từ MES và lưu vào context với tên MES[csn]
                    </td>
                    <td>Chế độ OFFLINE sẽ lỗi</td>
                </tr>
                <tr>

                    <td><b>mes.GET_CONTROL_TABLE</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>Lấy thông tin guankongbiao từ MES và lưu vào context lần lượt với tên
                        MES[{tên biến}]
                    </td>
                    <td>Chế độ OFFLINE sẽ lỗi. Liên hệ với MES để lấy các trường thông tin cần thiết.</td>
                </tr>
                <tr>
                    <td><b>mes.GET_PTID</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>Lấy PTID theo MBSNO</td>
                    <td>Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần lấy thông tin PTID.</td>
                </tr>
                <tr>
                    <td><b>mes.GET_MAC_LIST</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>Lấy một MAC mới hoặc MAC đã được ghép với MBSNO từ MES và lưu vào context với
                        tên MES[mac]
                    </td>
                    <td>
                        Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần ghi BT_MAC, WIFI_MAC, hoặc ETH_MAC mà cần lấy MAC
                        mới từ MES.
                    </td>
                </tr>
                <tr>
                    <td><b>mes.GET_MAC_LIST_EX</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>Lấy danh sách MAC và lưu vào context. Cần liên hệ MES để có thể lấy được MAC.</td>
                    <td>Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần ghi BT_MAC, WIFI_MAC, hoặc ETH_MAC mà cần lấy MAC
                        mới từ MES.
                        hoặc ETH_MAC mà cần lấy MAC mới từ MES.
                    </td>
                </tr>
                <tr>
                    <td><b>mes.GET_CONTROL_TABLE</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>Lấy danh sách thông tin guankongbiao từ MES và lưu vào context lần lượt với tên
                        MES[{tên biến}]
                    </td>
                    <td>Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần lấy thông tin guankongbiao để so sánh.
                    </td>
                </tr>
                <tr>
                    <td><b>mes.GET_VARIABLES_BY_STATION_JSON</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>Lấy các biến MES cung cấp xuống. Thường sẽ dùng cái này để lấy imei. Do MES cung cấp.</td>
                    <td>Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần ghi BT_MAC, WIFI_MAC,
                        hoặc ETH_MAC mà cần lấy MAC mới từ MES.
                    </td>
                </tr>
                <tr>
                    <td><b>mes.GET_VARIABLES_CHECK_JSON</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>- API mes cung cấp lấy giá trị 1 biến.</td>
                    <td>Chế độ OFFLINE sẽ lỗi.</td>
                </tr>

                <tr>
                    <td><b>mes.SAVE_VARIABLE_IGNORE_NON_SETTING_JSON</b></td>
                    <td>
                        <pre>
<b>- var_name:</b> tên biến.
<b>- var_value:</b> giá trị biến.
                        </pre>
                    </td>
                    <td>PASS FAIL</td>
                    <td>- API mes cung cấp đặt giá trị cho 1 biến.</td>
                    <td>Chế độ OFFLINE sẽ lỗi.</td>
                </tr>

                <tr>
                    <td><b>mes.SAVE_VARIABLES_BY_STATION_JSON</b></td>
                    <td>
                        <pre>
<b>- var_name:</b> tên biến.
<b>- var_value:</b> giá trị biến.
                        </pre>
                    </td>
                    <td>PASS FAIL</td>
                    <td>- API mes cung cấp đặt giá trị cho 1 biến.</td>
                    <td>Chế độ OFFLINE sẽ lỗi.</td>
                </tr>

                <tr>
                    <td><b>mes.GET_NEW_IMEI</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>Lấy một IMEI mới từ MES và lưu vào context với tên MES[imei]</td>
                    <td>Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần ghi IMEI mới lấy từ MES.</td>
                </tr>

                <tr>
                    <td><b>mes.GET_IMEI_FROM_SNO_CODE</b></td>
                    <td>~</td>
                    <td>PASS FAIL</td>
                    <td>Lấy một IMEI mới từ MES và lưu vào context với tên MES[imei]</td>
                    <td>Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần ghi IMEI mới lấy từ MES.</td>
                </tr>

                <tr>
                    <td><b>mes.UPLOAD_BT_MAC</b></td>
                    <td>
                        <pre>
<b>- mac:</b> MAC 
                    </pre>
                    </td>
                    <td>PASS FAIL</td>
                    <td>Upload BT MAC đã ghi lên MES.</td>
                    <td>Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần upload BT MAC lên MES. MAC lấy ở item test trước
                        đó.
                    </td>
                </tr>

                <tr>
                    <td><b>mes.UPLOAD_WIFI_MAC</b></td>
                    <td>
                        <pre>
<b>- mac:</b> MAC 
                    </pre>
                    </td>
                    <td>PASS FAIL</td>
                    <td>Upload WIFI MAC đã ghi lên MES.</td>
                    <td>
                        Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần upload WIFI MAC lên MES. MAC đã được đọc và lưu vào
                        context ở item trước đó.
                    </td>
                </tr>

                <tr>
                    <td><b>mes.UPLOAD_ETH_MAC</b></td>
                    <td>
                        <pre>
<b>- mac:</b> MAC
                    </pre>
                    </td>
                    <td>PASS FAIL</td>
                    <td>Upload ETH MAC đã ghi lên MES.</td>
                    <td>Chế độ OFFLINE sẽ lỗi. Dành cho các trạm cần upload ETH MAC lên MES.
                        MAC đã được đọc và lưu vào context ở item trước đó.
                    </td>
                </tr>
        </table>

        <h2>logger: ghi log</h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>logger.info</b></td>
                    <td>
                        <pre>
 <b>- message:</b> chuỗi cần log.
                    </pre>
                    </td>
                    <td>true</td>
                    <td>Ghi một thông điệp ở mức INFO vào log.</td>
                    <td>chuỗi có thể là chuỗi tĩnh hoặc sử dụng String Resolve để tạo chuỗi động.</td>
                </tr>
            </tbody>
        </table>

        <h2>com: giao tiếp cổng COM</h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>com.open</b></td>
                    <td>
                        <pre>
<b>- name:</b> tên định danh.
<b>- port:</b> tên cổng.
<b>- baudrate:</b> tốc độ baud.
                    </pre>
                    </td>
                    <td>true</td>
                    <td>Mở kết nối đến cổng COM.</td>
                    <td>tên định danh dùng để tham chiếu cổng COM này trong các lệnh tiếp theo.</td>
                </tr>

                <tr>
                    <td><b>com.close</b></td>
                    <td>
                        <pre>
<b>- name:</b> tên định danh.
                    </pre>
                    </td>
                    <td>true</td>
                    <td>Đóng kết nối đến cổng COM.</td>
                    <td>- Chương trình sẽ tự đóng cổng COM tự động. Cần dùng khi cần kiểm soát đóng cổng COM để thực
                        hiện lệnh tiếp theo.
                    </td>
                </tr>

                <tr>
                    <td><b>com.wait_bytes_count</b></td>
                    <td>
                        <pre>
<b>- name: </b> tên định danh.
<b>- expect_count: </b> số byte.
<b>- timeout: </b> thời gian chờ (s).
                    </pre>
                    </td>
                    <td>true false</td>
                    <td>Chờ đến khi có đủ số byte nhận được từ cổng COM.</td>
                    <td>Trả về false nếu vượt quá thời gian chờ.</td>
                </tr>

                <tr>
                    <td><b>com.wait_string</b></td>
                    <td>
                        <pre>
<b>- name: </b> tên định danh.
<b>- expect: </b> chuỗi mong đợi.
<b>- timeout: </b> thời gian chờ (s).
                    </pre>
                    </td>
                    <td>true false</td>
                    <td>Chờ đến khi nhận được chuỗi mong đợi từ cổng COM.</td>
                    <td>
                        <pre>
- Trả về false nếu vượt quá thời gian chờ.
- <b>expect</b>: dùng chuỗi string hoặc `re_expression` để khớp với một biểu thức chính quy.
                        </pre>
                    </td>
                </tr>

                <tr>
                    <td><b>com.send_bytes</b></td>
                    <td>
                        <pre>
<b>- name: </b> tên định danh.
<b>- command: </b> chuỗi gửi.
<b>- sleep: </b> thời gian delay sau khi gửi (s)
                    </pre>
                    </td>
                    <td>true</td>
                    <td>Gửi một chuỗi dạng bytes đến cổng COM.</td>
                    <td>- chuỗi dạng hex ví dụ: "0A 1B 2C"</td>
                </tr>

                <tr>
                    <td><b>com.send_string</b></td>
                    <td>
                        <pre>
<b>- name: </b> tên định danh.
<b>- command: </b> chuỗi gửi.
<b>- sleep: </b> thời gian delay sau khi gửi (s)
                    </pre>
                    </td>
                    <td>true</td>
                    <td>Gửi một chuỗi đến cổng COM.</td>
                    <td>- Gửi enter bằng cách sử dụng `\r\n`</td>
                </tr>

                <tr>
                    <td><b>com.send_chars</b></td>
                    <td>
                        <pre>
<b>- name: </b> tên định danh.
<b>- command: </b> chuỗi gửi.
<b>delay: </b> thời gian delay giữa các ký tự (s). Dùng 0.01 là 10ms
<b>- sleep: </b> thời gian delay sau khi gửi (s)
                    </pre>
                    </td>
                    <td>true</td>
                    <td>Gửi một chuỗi đến cổng COM.</td>
                    <td>- Gửi enter bằng cách sử dụng `\r\n`</td>
                </tr>

                <tr>
                    <td><b>com.send_wait</b></td>
                    <td>
                        <pre>
<b>- name: </b> tên định danh.
<b>- command:</b> chuỗi gửi.
<b>- retry_times: </b> số lần retry.
<b>- expect: </b> chuỗi mong đợi.
<b>- timeout: </b> thời gian chờ (s).
                        </pre>
                    </td>
                    <td>true false</td>
                    <td>Gửi một chuỗi đến cổng COM và chờ phản hồi mong đợi.</td>
                    <td>
                        <pre>
Trả về false nếu không thành công.
- <b>expect</b>: dùng chuỗi string hoặc `re_expression` để khớp với một biểu thức chính quy.
                        </pre>
                    </td>
                </tr>

                <tr>
                    <td><b>com.check_log</b></td>
                    <td>
                        <pre>
<b>- name:</b> tên định danh.
<b>- expect:</b> chuỗi mong đợi.
                        </pre>
                    </td>
                    <td>true false</td>
                    <td>Kiểm tra xem chuỗi mong đợi có xuất hiện trong log nhận được từ cổng COM hay không.</td>
                    <td>
                        <pre>
- Trả về false nếu không tìm thấy.
<b>- expect</b>: dùng chuỗi string hoặc `re_expression` để khớp với một biểu thức chính quy.
                        </pre>
                    </td>
                </tr>

                <tr>
                    <td><b>com.read_value</b></td>
                    <td>
                        <pre>
<b>- name:</b> tên định danh.
<b>- expect:</b> chuỗi mong đợi.
<b>- match_index:</b> index của chuỗi match cần lấy.
<b>- replace:</b> chuỗi cần thay thế.
<b>- replace_with:</b> giá trị thay thế.
<b>- convert:</b> to_lower | to_upper.
<b>- var_name:</b> tên biến lưu giá trị.
                    </pre>
                    </td>
                    <td>true false</td>
                    <td>Đọc một giá trị từ log nhận được và lưu vào <b>context</b>.</td>
                    <td>
                        <pre>Trả về false nếu không tìm thấy.
- <b>expect</b>: dùng chuỗi string hoặc `re_expression` để khớp với một biểu thức chính quy.
- <b>index</b>: vị trí nhóm cần lấy.
- <b>replace</b>: dùng trực tiếp regex.
- <b>replace_with</b>: dùng chuỗi string.
                    </pre>
                    </td>
                </tr>

                <tr>
                    <td><b>com.wait_check</b></td>
                    <td>
                        <pre>
<b>- name:</b> tên định danh.
<b>- expect_wait:</b>- chuỗi mong đợi.
<b>- expect_check:</b> chuỗi kiểm tra.
<b>- timeout:</b> thời gian chờ (s).
                    </pre>
                    </td>
                    <td>true false</td>
                    <td>Chờ đến khi nhận được chuỗi mong đợi và kiểm tra chuỗi kiểm tra có xuất hiện trong log hay
                        không.
                    </td>
                    <td>
                        <pre>Trả về false nếu không thành công.
- <b>expect_wait</b>, <b>expect_check</b>: dùng chuỗi string hoặc `re_expression` để khớp với một biểu thức chính quy.
                    </pre>
                    </td>
                </tr>

                <tr>
                    <td><b>com.clear_log</b></td>
                    <td>
                        <pre>
<b>- name: </b> tên định danh.
                    </pre>
                    </td>
                    <td>true</td>
                    <td>- Xóa log tạm của com hiện tại. Thường dùng với `read_value`,
                        `check_log` phía trên.
                    </td>
                </tr>
            </tbody>
        </table>

        <h2>dialog: hiển thị hộp thoại</h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>func.sleep</b></td>
                    <td>
                        <pre>
<b>- time:</b> thời gian tạm dừng (s).
                </pre>
                    </td>
                    <td>true</td>
                    <td>Tạm dừng thực thi trong một khoảng thời gian.</td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>dialog.show</b></td>
                    <td>
                        <pre>
<b>- title:</b> tiêu đề hộp thoại.
<b>- message:</b> nội dung hiển thị.
                </pre>
                    </td>
                    <td>true</td>
                    <td>Hiển thị hộp thoại thông báo và chờ người dùng xác nhận <b>OK</b>.</td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>dialog.confirm</b></td>
                    <td>
                        <pre>
<b>- title:</b> tiêu đề hộp thoại.
<b>- message:</b> nội dung hiển thị.
                </pre>
                    </td>
                    <td>true false</td>
                    <td>
                        Hiển thị hộp thoại xác nhận và chờ người dùng chọn
                        <b>YES / OK</b> hoặc <b>NO / Cancel</b>.
                    </td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>dialog.input</b></td>
                    <td>
                        <pre>
<b>- title:</b> tiêu đề hộp thoại.
<b>- message:</b> nội dung hiển thị.
<b>- var_name:</b> tên biến lưu giá trị vào <b>context</b>.
                </pre>
                    </td>
                    <td>true</td>
                    <td>
                        Hiển thị hộp thoại nhập liệu và lưu giá trị người dùng nhập vào
                        <b>context</b>.
                    </td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>dialog.show_with_auto_close</b></td>
                    <td>
                        <pre>
<b>- title:</b> tiêu đề hộp thoại.
<b>- message:</b> nội dung hiển thị.
<b>- timeout:</b> thời gian hiển thị tối đa (s).
                </pre>
                    </td>
                    <td>true</td>
                    <td>
                        Hiển thị hộp thoại thông báo, tự động đóng sau thời gian
                        <b>timeout</b>.
                    </td>
                    <td>-</td>
                </tr>
            </tbody>
        </table>

        <h2>func: các hàm tuỳ chỉnh</h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>func.check_context_key_exist</b></td>
                    <td>
                        <pre>
<b>- key:</b> tên key cần kiểm tra trong context.
                </pre>
                    </td>
                    <td>true false</td>
                    <td>Kiểm tra xem trong context có tồn tại key hay không.</td>
                    <td>
                        <pre>
- Thường dùng khi lấy thông tin từ MES.<br>
- Giúp xác định lỗi do MES không trả dữ liệu.<br>
- Không bắt buộc phải dùng.
                    </pre>
                    </td>
                </tr>

                <tr>
                    <td><b>func.get_current_datetime</b></td>
                    <td>
                        <pre>
<b>- source:</b> nguồn thời gian (pc | mes).
<b>- format:</b> định dạng thời gian (theo C#).
<b>- var_name:</b> tên biến lưu vào context.
                </pre>
                    </td>
                    <td>true</td>
                    <td>Lấy thời gian (PC|MES) và lưu vào context dạng string.</td>
                    <td>
                        - Định dạng thời gian theo chuẩn C# DateTime.<br>
                        - Ví dụ: <b>ddMMyyyyHHmmss</b><br>
                        - dùng cho các trạm cần ghi datetime.
                    </td>
                </tr>

                <tr>
                    <td><b>func.date_time_check</b></td>
                    <td>
                        <pre>
<b>- prod_date_time:</b> thời gian cần so sánh.
<b>- prod_date_time_format:</b> định dạng thời gian (theo C#).
<b>- prod_date_time_utc:</b> dùng nếu giờ sản phẩm là UTC.
<b>- source:</b> nguồn thời gian (pc | mes).
<b>- duration:</b> sai lệch cho phép (s).
                </pre>
                    </td>
                    <td>true false</td>
                    <td>Kiểm tra thời gian có nằm trong khoảng cho phép hay không.</td>
                    <td>
                        - Định dạng thời gian theo chuẩn C# DateTime.<br>
                        - Ví dụ: <b>dd/MM/yyyy HH:mm:ss</b>
                    </td>
                </tr>

                <tr>
                    <td><b>func.date_check</b></td>
                    <td>
                        <pre>
<b>- prod_date_time:</b> thời gian cần so sánh.
<b>- prod_date_time_format:</b> định dạng thời gian (theo C#).
<b>- source:</b> nguồn thời gian (pc | mes).
                </pre>
                    </td>
                    <td>true false</td>
                    <td>Kiểm tra ngày có khớp với ngày hiện tại hay không.</td>
                    <td>
                        - Định dạng thời gian theo chuẩn C# DateTime.
                    </td>
                </tr>

                <tr>
                    <td><b>func.string_match</b></td>
                    <td>
                        <pre>
<b>- source:</b> chuỗi nguồn.
<b>- expect:</b> chuỗi hoặc biểu thức mong đợi.
                </pre>
                    </td>
                    <td>true false</td>
                    <td>Kiểm tra chuỗi nguồn có chứa giá trị mong đợi hay không.</td>
                    <td>
                        - <b>expect</b>: string hoặc `re_expression`</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>func.read_value</b></td>
                    <td>
                        <pre>
<b>- source:</b> chuỗi nguồn.
<b>- expect:</b> chuỗi / regex để match.
<b>- match_index:</b> index nhóm cần lấy.
<b>- replace:</b> regex cần thay thế.
<b>- replace_with:</b> chuỗi thay thế.
<b>- convert:</b> to_lower | to_upper.
<b>- var_name:</b> tên biến lưu vào context.
                </pre>
                    </td>
                    <td>true false</td>
                    <td>Đọc giá trị từ log và lưu vào <b>context</b>.</td>
                    <td>
                        <spec>
                            - Trả về <b>false</b> nếu không match.
                            - <b>expect</b>: string hoặc regex.
                            - <b>match_index</b>: vị trí nhóm regex.
                            - <b>replace</b>: dùng regex.
                        </spec>
                    </td>
                </tr>

                <tr>
                    <td><b>func.reverse_string</b></td>
                    <td>
                        <pre>
<b>- source:</b> chuỗi dữ liệu nguồn.
<b>- var_name:</b> biến lưu vào context.
                </pre>
                    </td>
                    <td>true</td>
                    <td>Đảo ngược chuỗi và lưu kết quả vào <b>context</b>.</td>
                    <td>
                        - Ví dụ: <b>abcde</b> → <b>edcba</b>
                    </td>
                </tr>

                <tr>
                    <td><b>func.reverse_mac</b></td>
                    <td>
                        <pre>
<b>- source:</b> chuỗi MAC nguồn.
<b>- var_name:</b> biến lưu vào context.
                </pre>
                    </td>
                    <td>true</td>
                    <td>Đảo ngược chuỗi MAC đọc từ lệnh AT.</td>
                    <td>
                        - Ví dụ: <b>6f5d4e3c2b1a</b> → <b>1a2b3c4d5e6f</b>
                    </td>
                </tr>

                <tr>
                    <td><b>func.get_imei_from_response</b></td>
                    <td>
                        <pre>
<b>- source:</b> chuỗi dữ liệu nguồn.
<b>- var_name:</b> biến lưu IMEI vào context.
                </pre>
                    </td>
                    <td>true</td>
                    <td>
                        <pre>
Convert text response thành IMEI. Dùng cho lệnh: <b>adb shell service call iphonesubinfo 3 i32 0</b>
                    </pre>
                    </td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>func.cm5_picture_measure</b></td>
                    <td>
                        <pre>
<b>- lower_limit:</b> giá trị dưới.
<b>- upper_limit:</b> giá trị trên.
<b>- picture_name:</b> tên file ảnh.
<b>- golden_sample_folder_path:</b> thư mục GOLDEN SAMPLE.
                </pre>
                    </td>
                    <td>true false</td>
                    <td>Tính MSE ảnh cho trạm CM5 CAMERA.</td>
                    <td>
                        - <b>picture_name</b>: ví dụ <b>FRONT_LIGHT_ON.jpg</b>
                    </td>
                </tr>

                <tr>
                    <td><b>func.generate_imei2_from_imei1</b></td>
                    <td>
                        <pre>
<b>- imei1:</b> giá trị IMEI1 (15 ký tự).
                </pre>
                    </td>
                    <td>true</td>
                    <td>
                        Sinh IMEI2 từ IMEI1 và lưu vào <b>context["PROD[imei2]"]</b>.
                    </td>
                    <td>
                        - <b>imei1</b> bắt buộc đủ 15 ký tự.
                    </td>
                </tr>

                <tr>
                    <td><b>func.check_com_device_exist</b></td>
                    <td>
                        <pre>
<b>- com_name:</b> tên cổng COM cần kiểm tra.
                    </pre>
                    </td>
                    <td>true false</td>
                    <td>
                        Kiểm tra cổng COM có xuất hiện trên Device Manager hay không.
                    </td>
                    <td>
                        - Dùng cho UX300.<br>
                        - Kiểm tra thiết bị dạng <b>USB Serial Device</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>func.append_text_to_file</b></td>
                    <td>
                        <pre>
<b>- file_path:</b> file cần ghi text.
<b>- text:</b> nội dung cần thêm vào file. Thêm \r\n để xuống dòng.
                        </pre>
                    </td>
                    <td>true</td>
                    <td>Ghi nội dung text vào file.</td>
                    <td></td>
                </tr>
            </tbody>
        </table>

        <h2>if: hàm thực hiện logic</h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>if.condition</b></td>
                    <td>
                        <pre>
<b>- condition:</b> biểu thức điều kiện logic.
                </pre>
                    </td>
                    <td>true false</td>
                    <td>
                        Thực hiện kiểm tra logic theo biểu thức điều kiện. (Phương thức cũ – khuyến nghị dùng các hàm
                        bên dưới)
                    </td>
                    <td>
                        - Trả về <b>false</b> nếu lệnh CMD lỗi hoặc timeout.<br>
                        - Trả về <b>true</b> nếu lệnh CMD thực thi thành công.
                    </td>
                </tr>

                <tr>
                    <td><b>if.is_equal</b></td>
                    <td>
                        <pre>
<b>- source:</b> giá trị cần so sánh.
<b>- expect:</b> giá trị mong đợi.
                </pre>
                    </td>
                    <td>true false</td>
                    <td>
                        Kiểm tra điều kiện <b>source == expect</b>.
                    </td>
                    <td>
                        <pre>
- Chỉ dùng cho <b>giá trị số</b>.
- So sánh chuỗi dùng <b>func.string_match</b>.
                    </pre>
                    </td>
                </tr>

                <tr>
                    <td><b>if.is_greater_than</b></td>
                    <td>
                        <pre>
<b>- source:</b> giá trị cần so sánh.
<b>- lower_limit:</b> giá trị so sánh.
                    </pre>
                    </td>
                    <td>true false</td>
                    <td>
                        Kiểm tra điều kiện <b>source &gt; lower_limit</b>.
                    </td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>if.is_greater_than_or_equal</b></td>
                    <td>
                        <pre>
<b>- source:</b> giá trị cần so sánh.
<b>- lower_limit:</b> giá trị so sánh.
                    </pre>
                    </td>
                    <td>true false</td>
                    <td>
                        Kiểm tra điều kiện <b>source &gt;= lower_limit</b>.
                    </td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>if.is_less_than</b></td>
                    <td>
                        <pre>
<b>- source:</b> giá trị cần so sánh.
<b>- upper_limit:</b> giá trị so sánh.
                    </pre>
                    </td>
                    <td>true false</td>
                    <td>
                        Kiểm tra điều kiện <b>source &lt; upper_limit</b>.
                    </td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>if.is_less_than_or_equal</b></td>
                    <td>
                        <pre>
<b>- source:</b> giá trị cần so sánh.
<b>- upper_limit:</b> giá trị so sánh.
                </pre>
                    </td>
                    <td>true false</td>
                    <td>
                        Kiểm tra điều kiện <b>source &lt;= upper_limit</b>.
                    </td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>if.in_between</b></td>
                    <td>
                        <pre>
<b>- source:</b> giá trị cần so sánh.
<b>- lower_limit:</b> giá trị dưới.
<b>- upper_limit:</b> giá trị trên.
                </pre>
                    </td>
                    <td>true false</td>
                    <td>
                        Kiểm tra điều kiện
                        <b>source &gt;= lower_limit &amp; source &lt;= upper_limit</b>.
                    </td>
                    <td>-</td>
                </tr>
            </tbody>
        </table>

        <h2>Các hàm thao tác với phần mềm bên thứ 3</h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>atmel.AUTO</b></td>
                    <td>
                        <pre>
<b>- working_path: </b>đường dẫn chương trình <b>AtmelSecureAccess</b>
                    </pre>
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Sử dụng tool <b>AtmelSecureAccess</b> để flash key vào sản phẩm.
                        Áp dụng cho dòng <b>UX100 / UX110</b>.
                    </td>
                    <td>
                        - Tool <b>AtmelSecureAccess</b> có thể được cấu hình để tự động tải về.<br>
                        - Ở lần chạy đầu tiên, cần cấu hình thủ công tool trong thư mục đã tải.
                    </td>
                </tr>

                <tr>
                    <td><b>icimei.AUTO</b></td>
                    <td>
                        <pre>
<b>- working_path: </b>đường dẫn thư mục chứa chương trình.
<b>- comport: </b>cổng COM dùng để ghi IMEI.
<b>- imei: </b>IMEI cần ghi (độ dài 15 số).
                    </pre>
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Sử dụng tool <b>icimei.exe</b> để ghi IMEI vào sản phẩm.
                    </td>
                    <td>
                        - Tool có thể được cấu hình để tự động tải về.<br>
                        - Trước khi chạy, sản phẩm phải ở <b>chế độ AT</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>icimei.auto</b></td>
                    <td>
                        <pre>
<b>- working_path: </b>đường dẫn thư mục chứa chương trình.
<b>- comport: </b>cổng COM dùng để ghi IMEI.
<b>- imei: </b>IMEI cần ghi (độ dài 15 số).
                    </pre>
                    </td>
                    <td>true / false</td>
                    <td>
                        Tương tự <b>icimei.AUTO</b> nhưng hỗ trợ luồng xử lý <b>on_success</b> và <b>on_fail</b>.
                    </td>
                    <td>
                        - Chỉ các lỗi <b>ICIMEI_TIMEOUT</b> và <b>ICIMEI_WRITE_IMEI_FAIL</b> mới trả về <b>true /
                            false</b>.<br>
                        - Các lỗi khác sẽ trả về <b>FAIL</b>.<br>
                        - Sản phẩm phải ở <b>chế độ AT</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>jlink.AUTO</b></td>
                    <td>
                        <pre>
<b>- working_path: </b>đường dẫn chương trình JLink.
<b>- project_path: </b> đường dẫn file project.
<b>- flash_file_path: </b> đường dẫn file `.bin`.
<b>- usb_sn: </b> serial number của JLink.
                    </pre>
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Sử dụng tool <b>JFlash</b> để flash bootloader vào sản phẩm.
                    </td>
                    <td>
                        - Tool JLink, file project và file bin có thể được cấu hình để tự tải.<br>
                        - Nếu dùng nhiều JLink, nên cố định <b>usb_sn</b>.<br>
                        - Đặt <b>usb_sn: ~</b> để tự động chọn.
                    </td>
                </tr>

                <tr>
                    <td><b>mib.AUTO</b></td>
                    <td>
                        <pre>
<b>- customer_pn:</b>
<b>- bomver:</b>
<b>- sn:</b>
<b>- ptid:</b>
<b>- wifi_mac:</b>
<b>- bt_mac:</b>
<b>- lan_mac:</b>
<b>- uwb_mac:</b>    
                    </pre>
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Tự động chạy tool <b>MIB</b> với các thông tin đầu vào được cung cấp.
                    </td>
                    <td>
                        - Tool <b>MIB</b> và <b>WinConnect</b> cần được mở và cấu hình thủ công trước.<br>
                        - Trường không sử dụng đặt giá trị là <b>NA</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>mt.AUTO</b></td>
                    <td>
                        <pre>
<b>- working_path:</b> thư mục làm việc.
<b>- exe_name:</b> tên file thực thi.
<b>- ict_sn_01:</b> serial board 1.
<b>- ict_sn_02:</b> serial board 2.
                    </pre>
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Tự động chạy tool <b>ManufacturingTool</b> với các tham số được chỉ định.
                    </td>
                    <td>
                        <pre>
- exe_name thường là <b>PCBA_tests.exe</b>.<br>
- ict_sn_* không dùng thì đặt <b>~</b>.<br>
- Có thể dùng <b>$context</b> làm input.<br>
- Nên kết hợp với các method <b>mt.check*</b> để kiểm tra kết quả.
                    </pre>
                    </td>
                </tr>

                <tr>
                    <td><b>mt.check_log</b></td>
                    <td>
                        <pre>
<b>- expect:</b> chuỗi hoặc biểu thức mong đợi
                    </pre>
                    </td>
                    <td>true / false</td>
                    <td>
                        Kiểm tra chuỗi mong đợi có xuất hiện trong log của tool MT hay không.
                    </td>
                    <td>
                        - Không tìm thấy trả về <b>false</b>.<br>
                        - Hỗ trợ chuỗi thường hoặc `re_expression`</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>mt.check_board_log</b></td>
                    <td>
                        <pre>
<b>- board_id:</b> ID của board.
<b>- expect:</b> chuỗi mong đợi.
                    </pre>
                    </td>
                    <td>true / false</td>
                    <td>
                        Kiểm tra log của board cụ thể trong tool MT.
                    </td>
                    <td>
                        - Không tìm thấy trả về <b>false</b>.<br>
                        - Hỗ trợ regex với <b>re_expression</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>mt.check_tasklist</b></td>
                    <td>
                        <pre>
<b>- board_id:</b> ID của board.
<b>- expect:</b> chuỗi mong đợi.
                    </pre>
                    </td>
                    <td>true / false</td>
                    <td>
                        Kiểm tra tasklist của board trong tool MT.
                    </td>
                    <td>
                        - Không tìm thấy trả về <b>false</b>.<br>
                        - Hỗ trợ regex với <b>re_expression</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>pms.AUTO</b></td>
                    <td>
                        <pre>
<b>- working_path: </b>
<b>- exe_name: </b>
<b>- bt_mac: </b>
<b>- wifi_mac: </b>
<b>- eth_mac: </b>
                    </pre>
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Tự động chạy tool <b>PMS Simulation</b>.
                    </td>
                    <td>
                        - exe_name thường là <b>PMS_Simulation_Window_V1.09.exe</b>.<br>
                        - MAC không dùng đặt <b>~</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>qcm.AUTO</b></td>
                    <td>
                        <b>- imei:</b> IMEI cần ghi (thường là <b>$context MES[imei]</b>)
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Ghi IMEI bằng tool <b>QCMWriteImei.exe</b>.
                    </td>
                    <td>
                        - Tool phải được <b>đăng nhập và mở thủ công</b> trước khi chạy.
                    </td>
                </tr>

                <tr>
                    <td><b>qcm.auto</b></td>
                    <td>
                        <b>- imei:</b> IMEI cần ghi
                    </td>
                    <td>true / false</td>
                    <td>
                        Giống <b>qcm.AUTO</b> nhưng không thoát ngay sau khi ghi.
                    </td>
                    <td>
                        - Dùng khi cần gửi thêm lệnh AT ở <b>on_success</b> / <b>on_fail</b>.<br>
                        - Tool QCM có bug: khi fail COM vẫn bị giữ, không thoát được AT.
                    </td>
                </tr>

                <tr>
                    <td><b>qfil.AUTO</b></td>
                    <td>
                        <b>- working_path:</b> thư mục QFIL<br>
                        <b>- comport:</b> số slot (1,2,3) hoặc <b>~</b><br>
                        <b>- image_path:</b> thư mục chứa file <b>.mbn</b><br>
                        <b>- timeout:</b> thời gian chờ (giây)
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Flash image vào thiết bị bằng tool <b>QFIL</b>.
                    </td>
                    <td>
                        - Nên cấu hình để QFIL tự tải về và sử dụng bản đó.
                    </td>
                </tr>

                <tr>
                    <td><b>qwit.AUTO</b></td>
                    <td>
                        <b>- working_path:</b><br>
                        <b>- exe_name:</b><br>
                        <b>- imei:</b> (15 số)
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Ghi IMEI bằng tool <b>Quectel_Write_IMEI_OFFLINE</b>.
                    </td>
                    <td>
                        - Mặc định exe_name: <b>Quectel_Write_IMEI_OFFLINE_V1.8.1.exe</b><br>
                        - Sản phẩm phải ở chế độ AT.
                    </td>
                </tr>

                <tr>
                    <td><b>vtp.AUTO</b></td>
                    <td>
                        <b>- working_path:</b><br>
                        <b>- exe_name:</b><br>
                        <b>- xml_name:</b><br>
                        <b>- timeout:</b>
                    </td>
                    <td>PASS / FAIL</td>
                    <td>
                        Tự động chạy tool <b>VTP</b> với script XML chỉ định.
                    </td>
                    <td>
                        - Nên cấu hình để tool VTP tự tải.<br>
                        - Đảm bảo <b>SN_LENGTH = 14</b> trong cấu hình VTP.
                    </td>
                </tr>
            </tbody>
        </table>

        <h2>cmd: Thực thi lệnh CMD và lấy log</h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>cmd.execute</b></td>
                    <td>
                        <b>- name:</b> tên định danh của lệnh CMD<br>
                        <b>- command:</b> lệnh CMD cần thực thi<br>
                        <b>- working_path:</b> thư mục thực thi lệnh (tuỳ chọn)<br>
                        <b>- timeout:</b> thời gian chờ tối đa (giây)
                    </td>
                    <td>true / false</td>
                    <td>
                        Thực thi một lệnh CMD và thu thập toàn bộ log (stdout / stderr) trả về.
                    </td>
                    <td>
                        - Trả về <b>false</b> nếu lệnh thực thi lỗi hoặc vượt quá <b>timeout</b>.<br>
                        - Trả về <b>true</b> nếu lệnh kết thúc thành công.<br>
                        - Log của lệnh được lưu vào context với key: <b>CMD[{name}][log]</b>.<br>
                        - Có thể dùng log này cho các bước kiểm tra tiếp theo (ví dụ: <b>if</b>,
                        <b>func.string_match</b>, …).
                    </td>
                </tr>
            </tbody>
        </table>

        <h2>cam: Tương tác với <b>CAMERA</b></h2>
        <table class="doc-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>with</th>
                    <th>Kết quả</th>
                    <th>Mô tả</th>
                    <th>Chú ý</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><b>cam.set_operation_image</b></td>
                    <td>
                        <pre>
<b>- image_path:</b> đường dẫn file ảnh mẫu
                </pre>
                    </td>
                    <td>true</td>
                    <td>Thiết lập ảnh thao tác cho camera.</td>
                    <td>-</td>
                </tr>

                <tr>
                    <td><b>cam.check_ocr_string</b></td>
                    <td>
                        <pre>
<b>- wait_string:</b> chuỗi OCR mong đợi
<b>- timeout:</b> thời gian chờ (giây)
<b>- save_image_with_name:</b> tên file lưu ảnh OCR
<b>- expect:</b> chuỗi kiểm tra mong đợi
                </pre>
                    </td>
                    <td>true / false</td>
                    <td>
                        Đọc text từ ảnh camera, chờ <b>wait_string</b> xuất hiện,
                        sau đó kiểm tra <b>wait_string</b> có chứa <b>expect</b> hay không.
                    </td>
                    <td>
                        - Trả về <b>false</b> nếu không tìm thấy.<br>
                        - <b>wait_string</b>, <b>expect</b>: dùng string hoặc `re_expression`.<br>
                        - <b>save_image_with_name</b>: lưu ảnh OCR đã xử lý, không lưu thì để <b>~</b>.
                    </td>
                </tr>

                <tr>
                    <td><b>cam.get_ocr_string</b></td>
                    <td>
                        <pre>
<b>- wait_string:</b> chuỗi OCR mong đợi.
<b>- timeout:</b> thời gian chờ (giây).
<b>- save_image_with_name:</b> tên file lưu ảnh OCR.
<b>- var_name:</b> tên biến lưu vào context.
                </pre>
                    </td>
                    <td>true / false</td>
                    <td>
                        Đọc text từ ảnh camera, chờ <b>wait_string</b> xuất hiện, sau đó lưu chuỗi vào <b>context</b>
                        với tên <b>var_name</b>.
                    </td>
                    <td>
                        - Trả về <b>false</b> nếu không tìm thấy.<br>
                        - <b>wait_string</b>: dùng string hoặc `re_expression`<br>
                        - <b>save_image_with_name</b>: lưu ảnh OCR đã xử lý, không lưu thì để <b>~</b>.
                    </td>
                </tr>
            </tbody>
        </table>
    </main>
</body>

</html>